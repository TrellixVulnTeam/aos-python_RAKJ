{
  "label": "MLAG domain config sanity anomalies",
  "processors": [
    {
      "inputs": {},
      "type": "generic_data_collector",
      "name": "MLAG domain config sanity",
      "outputs": {
        "out": "mlag_domain_config_sanity"
      },
      "properties": {
        "graph_query": "node('system', name='mlag_system', system_id=not_none(), deploy_mode='deploy').out('part_of_redundancy_group').node('redundancy_group')",
        "data_type": "dss",
        "service_interval": "120",
        "service_name": "mlag_domain",
        "execution_count": "-1",
        "system_id": "mlag_system.system_id",
        "service_input": "\"\"",
        "key": "'config_sanity'",
        "enable_streaming": false,
        "value_map": {
          "0": "missing",
          "1": "consistent",
          "2": "inconsistent"
        }
      }
    },
    {
      "inputs": {
        "in": "mlag_domain_config_sanity"
      },
      "type": "range_check",
      "name": "Inconsistent MLAG domains",
      "outputs": {
        "out": "mlag_domain_inconsistent"
      },
      "properties": {
        "graph_query": [],
        "anomaly_retention_size": 1073741824,
        "anomaly_retention_duration": 86400,
        "range": {
          "max": 1,
          "min": 1
        },
        "raise_anomaly": false,
        "enable_streaming": false,
        "property": "value",
        "enable_anomaly_logging": false
      }
    },
    {
      "inputs": {
        "in": "mlag_domain_inconsistent"
      },
      "type": "state_check",
      "name": "Check inconsistent MLAG domains",
      "outputs": {
        "out": "check_mlag_domain_inconsistent"
      },
      "properties": {
        "graph_query": [],
        "anomaly_retention_size": 1073741824,
        "anomaly_retention_duration": 86400,
        "state": "'false'",
        "raise_anomaly": true,
        "enable_streaming": false,
        "enable_anomaly_logging": false
      }
    }
  ],
  "stages": [
    {
      "name": "mlag_domain_config_sanity",
      "retention_duration": 86400
    },
    {
      "name": "mlag_domain_inconsistent",
      "retention_duration": 86400
    },
    {
      "name": "check_mlag_domain_inconsistent",
      "retention_duration": 86400
    }
  ]
}