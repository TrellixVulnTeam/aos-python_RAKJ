{"label": "Data_Plane - Sustained packet discards", "processors": [{"inputs": {}, "type": "if_counter", "name": "Egress packet discard rate", "outputs": {"out": "egress_pkt_discard_rate"}, "properties": {"description": "str(interface.description)", "graph_query": "match(node('system', name='system', system_id=not_none(), deploy_mode='deploy', role=is_in(['leaf', 'spine'])).out('hosted_interfaces').node('interface', if_type=is_in(['ip','ethernet']), name='interface'))", "interface": "interface.if_name", "system_id": "system.system_id", "enable_streaming": false, "counter_type": "tx_discard_pps"}}, {"inputs": {}, "type": "if_counter", "name": "Ingress packet discard rate", "outputs": {"out": "ingress_pkt_discard_rate"}, "properties": {"description": "str(interface.description)", "graph_query": "match(node('system', name='system', system_id=not_none(), deploy_mode='deploy', role=is_in(['leaf', 'spine'])).out('hosted_interfaces').node('interface', if_type=is_in(['ip','ethernet']), name='interface'))", "interface": "interface.if_name", "system_id": "system.system_id", "enable_streaming": false, "counter_type": "rx_discard_pps"}}, {"inputs": {"in": "egress_pkt_discard_rate"}, "type": "range_check", "name": "Check non-zero egress packet discard rate", "outputs": {"out": "egress_has_pkt_discards"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": false, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}, {"inputs": {"in": "ingress_pkt_discard_rate"}, "type": "range_check", "name": "Check non-zero ingress packet discard rate", "outputs": {"out": "ingress_has_pkt_discards"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": false, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}, {"inputs": {"in": "egress_has_pkt_discards"}, "type": "time_in_state_check", "name": "Check if egress packet discard rates overtime", "outputs": {"out": "egress_has_sustained_pkt_discards"}, "properties": {"time_window": 120, "graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state_range": {"\"false\"": [{"min": 21}]}, "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}, {"inputs": {"in": "ingress_has_pkt_discards"}, "type": "time_in_state_check", "name": "Check if ingress packet discard rates overtime", "outputs": {"out": "ingress_has_sustained_pkt_discards"}, "properties": {"time_window": 120, "graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state_range": {"\"false\"": [{"min": 21}]}, "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}], "stages": [{"name": "egress_pkt_discard_rate", "retention_duration": 86400}, {"name": "egress_has_pkt_discards", "retention_duration": 86400}, {"name": "ingress_has_sustained_pkt_discards", "retention_duration": 86400}, {"name": "ingress_has_pkt_discards", "retention_duration": 86400}, {"name": "egress_has_sustained_pkt_discards", "retention_duration": 86400}, {"name": "ingress_pkt_discard_rate", "retention_duration": 86400}], "disabled": true}