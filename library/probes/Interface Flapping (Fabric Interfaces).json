{"label": "Data_Plane - Interface Flapping (Fabric Interfaces)", "description": "The probe determines if fabric interfaces are flapping", "processors": [{"inputs": {}, "type": "service_data_collector", "name": "leaf fab int status", "outputs": {"out": "leaf_if_status"}, "properties": {"enable_streaming": false, "service_name": "interface", "system_id": "system.system_id", "graph_query": "node(\"system\", name=\"system\", system_id=not_none(), role=\"leaf\").out(\"hosted_interfaces\").node(\"interface\", name=\"iface\", if_name=not_none()).out(\"link\").node(\"link\", link_type=\"ethernet\").in_(\"link\").node(\"interface\").in_(\"hosted_interfaces\").node(\"system\", role=\"spine\")", "key": "iface.if_name"}}, {"inputs": {"in": "leaf_if_status"}, "type": "accumulate", "name": "leaf fabric interface status history", "outputs": {"out": "leaf_fab_int_status_accumulate"}, "properties": {"enable_streaming": false, "max_samples": 1024, "graph_query": [], "total_duration": 60}}, {"inputs": {"in": "leaf_fab_int_status_accumulate"}, "type": "range_check", "name": "leaf fabric interface flapping", "outputs": {"out": "if_status_flapping"}, "properties": {"enable_streaming": false, "property": "sample_count", "range": {"min": 6}, "raise_anomaly": true, "graph_query": []}}, {"inputs": {"in": "if_status_flapping"}, "type": "accumulate", "name": "anomaly flap leaf fabric history", "outputs": {"out": "anomaly_accumulate"}, "properties": {"enable_streaming": false, "max_samples": 1024, "graph_query": [], "total_duration": 0}}, {"inputs": {"in": "if_status_flapping"}, "type": "match_perc", "name": "percentage flapping per device interfaces", "outputs": {"out": "flapping_fab_int_perc"}, "properties": {"enable_streaming": false, "group_by": ["system_id"], "reference_state": "true"}}, {"inputs": {"in": "flapping_fab_int_perc"}, "type": "range_check", "name": "system anomalous flapping", "outputs": {"out": "system_flapping"}, "properties": {"enable_streaming": false, "property": "value", "range": {"min": 11}, "raise_anomaly": true, "graph_query": []}}, {"inputs": {"in": "system_flapping"}, "type": "accumulate", "name": "system anomaly accumulate", "outputs": {"out": "system_flapping_anomaly_accumulate"}, "properties": {"enable_streaming": false, "max_samples": 1024, "graph_query": [], "total_duration": 0}}], "stages": [{"name": "flapping_fab_int_perc", "units": "%"}], "disabled": true}