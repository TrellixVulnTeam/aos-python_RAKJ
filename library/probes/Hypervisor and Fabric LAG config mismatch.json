{"label": "Virtual_Infra - Hypervisor and Fabric LAG config mismatch", "processors": [{"inputs": {}, "type": "generic_graph_collector", "name": "Hypervisor NICs with LAG", "outputs": {"out": "Hypervisor NICs LAG Intent Status"}, "properties": {"leaf": "str(leaf.hostname)", "graph_query": ["match(node('hypervisor', name='hv').out('has').node('pnic', name='hv_nic').out('is_realized_by').node('interface', name='server_intf').out('link').node('link').in_('link').node('interface', name='leaf_intf').in_('hosted_interfaces').node('system', name='leaf').ensure_different('server_intf', 'leaf_intf'),node(name='leaf_intf').in_('composed_of').node('interface', name='leaf_po'),node(name='hv_nic').in_('composed_of').node('port_channel', name='hv_po'),optional(node('port_channel', name='hv_po').out('is_realized_by').node('interface', name='matching_po')))", "match(node('hypervisor', name='hv').out('has').node('pnic', name='hv_nic').out('is_realized_by').node('interface', name='server_intf').out('link').node('link').in_('link').node('interface', name='leaf_intf').in_('hosted_interfaces').node('system', name='leaf').ensure_different('server_intf', 'leaf_intf').having(node(name='leaf_intf').in_('composed_of').node('interface'), at_most=0),node(name='hv_nic').in_('composed_of').node('port_channel', name='hv_po'),optional(node('undefined', name='leaf_po')),optional(node('port_channel', name='hv_po').out('is_realized_by').node('interface', name='matching_po')))", "match(node('hypervisor', name='hv').out('has').node('pnic', name='hv_nic').out('is_realized_by').node('interface', name='server_intf').out('link').node('link').in_('link').node('interface', name='leaf_intf').in_('hosted_interfaces').node('system', name='leaf').ensure_different('server_intf', 'leaf_intf').having(node(name='hv_nic').in_('composed_of').node('port_channel'), at_most=0),node(name='leaf_intf').in_('composed_of').node('interface', name='leaf_po'),optional(node('undefined', name='hv_po')),optional(node(name='leaf_po').in_('is_realized_by').node('port_channel', name='matching_po')))"], "data_type": "dss", "hypervisor": "str(hv.label)", "fabric_lag": "str(leaf_po.if_name if leaf_po else '')", "value": "'ok' if matching_po else 'mismatch'", "fabric_interface": "str(leaf_intf.if_name)", "value_map": {"1": "ok", "2": "mismatch"}, "enable_streaming": false, "pnic_lag": "str((hv_po.label or hv_po.port_channel_id)if hv_po else '')", "pnic": "str(hv_nic.label)"}}, {"inputs": {"in": "Hypervisor NICs LAG Intent Status"}, "type": "state_check", "name": "Hypervisor NIC LAG anomalies", "outputs": {"out": "Hypervisor NIC LAG Mismatch Anomaly"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state": "'mismatch'", "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}], "stages": [{"name": "Hypervisor NICs LAG Intent Status", "retention_duration": 86400}, {"name": "Hypervisor NIC LAG Mismatch Anomaly", "retention_duration": 86400}], "disabled": true}