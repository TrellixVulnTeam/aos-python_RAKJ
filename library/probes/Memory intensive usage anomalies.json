{"label": "Capacity_Planning - Memory intensive usage ", "processors": [{"inputs": {}, "type": "generic_data_collector", "name": "Collect resident memory rates", "outputs": {"out": "Memory_rate"}, "properties": {"data_type": "ns", "graph_query": "node('system', name='system', system_id=not_none(), deploy_mode='deploy').out('interface_map').node('interface_map').out('device_profile').node('device_profile', name='device_type_node').where(lambda device_type_node: device_type_node.selector['os'].lower() == 'junos')", "service_interval": "120", "process": "'rpd'", "service_name": "resource_usage", "device_type": "str(device_type_node.label)", "execution_count": "-1", "system_id": "system.system_id", "service_input": "\"\"", "key": "'rpd|memory_rate|VmRSS'", "enable_streaming": false}}, {"inputs": {"in": "Memory_rate"}, "type": "periodic_average", "name": "Periodic average of memory rate", "outputs": {"out": "Average_memory_rate"}, "properties": {"enable_streaming": false, "period": 1800, "graph_query": []}}, {"inputs": {"in": "Average_memory_rate"}, "type": "range_check", "name": "Memory rate of exceeding threshold", "outputs": {"out": "Memory_rate_out_of_range"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": false, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}, {"inputs": {"in": "Memory_rate_out_of_range"}, "type": "time_in_state_check", "name": "Sustained memory leak", "outputs": {"out": "Memory_leak"}, "properties": {"time_window": 36000, "graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state_range": {"\"false\"": [{"min": 35001}]}, "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}], "stages": [{"name": "Memory_rate", "enable_metric_logging": true, "retention_duration": 3600}, {"name": "Average_memory_rate", "retention_duration": 86400}, {"name": "Memory_leak", "retention_duration": 86400}, {"name": "Memory_rate_out_of_range", "retention_duration": 86400}], "disabled": true}