{"label": "Overlay - VxLAN MAC Table Info and Move ", "processors": [{"inputs": {}, "type": "generic_data_collector", "name": "Count of macs with multiple moves", "outputs": {"out": "vxlan_count_of_macs_with_multiple_moves"}, "properties": {"graph_query": "match(node('system', name='leaf', role='leaf', deploy_mode='deploy').out('hosted_vn_instances').node('vn_instance', name='vni').out('instantiates').node('virtual_network', name='vn', vn_type='vxlan'))", "data_type": "ns", "service_interval": "120", "service_name": "vxlan_address_table", "vni": "str(vn.vn_id)", "execution_count": "-1", "system_id": "leaf.system_id", "service_input": "\"\"", "key": "'vlan=%s|count_of_macs_with_multiple_moves' % (vni.vlan_id)", "enable_streaming": false}}, {"inputs": {}, "type": "generic_data_collector", "name": "VxLAN MAC Table Size", "outputs": {"out": "vxlan_mac_table_size"}, "properties": {"graph_query": "match(node('system', name='leaf', role='leaf', deploy_mode='deploy').out('hosted_vn_instances').node('vn_instance', name='vni').out('instantiates').node('virtual_network', name='vn', vn_type='vxlan'))", "data_type": "ns", "service_interval": "120", "service_name": "vxlan_address_table", "vni": "str(vn.vn_id)", "execution_count": "-1", "system_id": "leaf.system_id", "service_input": "\"\"", "key": "'vlan=%s|table_size' % (vni.vlan_id)", "enable_streaming": false}}, {"inputs": {}, "type": "generic_data_collector", "name": "VxLAN MACs with multiple moves", "outputs": {"out": "vxlan_macs_with_multiple_moves"}, "properties": {"graph_query": "match(node('system', name='leaf', role='leaf', deploy_mode='deploy').out('hosted_vn_instances').node('vn_instance', name='vni').out('instantiates').node('virtual_network', name='vn', vn_type='vxlan'))", "data_type": "ts", "service_interval": "120", "service_name": "vxlan_address_table", "vni": "str(vn.vn_id)", "execution_count": "-1", "system_id": "leaf.system_id", "service_input": "\"\"", "key": "'vlan=%s|macs_with_multiple_moves' % (vni.vlan_id)", "enable_streaming": false}}, {"inputs": {"in": "vxlan_count_of_macs_with_multiple_moves"}, "type": "range_check", "name": "MAC multi-move anomalies", "outputs": {"out": "vxlan_move_anomalies"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": true, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}], "stages": [{"name": "vxlan_count_of_macs_with_multiple_moves", "retention_duration": 86400}, {"name": "vxlan_move_anomalies", "retention_duration": 86400}, {"name": "vxlan_macs_with_multiple_moves", "retention_duration": 86400}, {"name": "vxlan_mac_table_size", "retention_duration": 86400}], "disabled": true}