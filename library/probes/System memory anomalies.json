{"label": "Device_Health - System memory ", "processors": [{"inputs": {}, "type": "generic_data_collector", "name": "Collect system memory rates", "outputs": {"out": "system memory_rate"}, "properties": {"graph_query": "match(node('system', name='system', system_id=not_none(), deploy_mode='deploy', role=is_in(['leaf', 'spine'])))", "data_type": "ns", "service_interval": "120", "service_name": "resource_usage", "execution_count": "-1", "system_id": "system.system_id", "service_input": "\"\"", "key": "'system|memory_rate'", "enable_streaming": false}}, {"inputs": {"in": "system memory_rate"}, "type": "periodic_average", "name": "Periodic average of system memory rate", "outputs": {"out": "system average_memory_rate"}, "properties": {"enable_streaming": false, "period": 1800, "graph_query": []}}, {"inputs": {"in": "system average_memory_rate"}, "type": "range_check", "name": "System memory rate exceeding threshold", "outputs": {"out": "system memory_rate_out_of_range"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": false, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}, {"inputs": {"in": "system memory_rate_out_of_range"}, "type": "time_in_state_check", "name": "Sustained system memory leak", "outputs": {"out": "system memory_leak"}, "properties": {"time_window": 36000, "graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state_range": {"\"false\"": [{"min": 35001}]}, "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}], "stages": [{"name": "system memory_rate_out_of_range", "retention_duration": 86400}, {"name": "system average_memory_rate", "retention_duration": 86400}, {"name": "system memory_leak", "retention_duration": 86400}, {"name": "system memory_rate", "enable_metric_logging": true, "retention_duration": 3600}], "disabled": true}