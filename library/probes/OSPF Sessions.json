{"label": "Layer3 - OSPF Sessions", "description": "Obtain telemetry status for the OSPF sessions", "processors": [{"inputs": {}, "type": "extensible_data_collector", "name": "OSPF session status", "outputs": {"out": "OSPF session status"}, "properties": {"data_type": "ts", "graph_query": ["match(node('system', name='system', role='leaf',     deploy_mode=is_in(['deploy', 'drain'])).out('hosted_interfaces').node('interface').out('composed_of').node('interface', name='interface', ipv4_addr=not_none()).out('protocol').node('protocol', routing='ospf', name='protocol'),node('interface', name='interface').out('link').node('link', link_type='logical_link').in_('link').node('interface', name='remote_interface'),node('interface', name='interface').in_('member_interfaces').node('sz_instance').in_('instantiated_by').node('security_zone', name='security_zone'),node('protocol', name='protocol').in_('ospf_domain').node('domain', domain_type='area', domain_id=not_none(),      name='ospf_domain'),optional(node(type='dummy', name='vn_instance')),optional(node('protocol', name='protocol').out('ospf_policy').node('ospf_policy', name='ospf_policy'))).ensure_different('interface', 'remote_interface')", "match(node('virtual_network', name='virtual_network').in_('member_of').node('vn_endpoint', name='vn_endpoint').in_('member_vn_endpoints').node('ip_endpoint', name='remote_interface'),node('virtual_network', name='virtual_network').out('instantiated_by').node('vn_instance', name='vn_instance').out('member_interfaces').node('interface', if_type='svi', name='interface').out('protocol').node('protocol', name='protocol', routing='ospf').in_('protocol').node('ip_endpoint', name='remote_interface'),node('vn_instance', name='vn_instance').in_('hosted_vn_instances').node('system', name='system', role='leaf', deploy_mode='deploy'),node('vn_endpoint', name='vn_endpoint').in_('hosted_vn_endpoints').node('interface', if_type=is_in(['ethernet', 'port_channel'])).in_('hosted_interfaces', name='remote_system'),node('virtual_network', name='virtual_network').in_('member_vns').node('security_zone', name='security_zone'),node('protocol', name='protocol').in_('ospf_domain').node('domain', domain_type='area', domain_id=not_none(),      name='ospf_domain'),optional(node('protocol', name='protocol').out('ospf_policy').node('ospf_policy', name='ospf_policy'))).select('system', 'remote_system', 'interface', 'remote_interface',         'ospf_domain', 'ospf_policy', 'security_zone', 'vn_instance')"], "area": "str(ospf_domain.domain_id)", "keys": ["vrf", "neighbor_addr", "area", "interface"], "service_name": "ospf_state", "service_interval": "120", "service_input": "\"\"", "execution_count": "-1", "system_id": "system.system_id", "vrf": "str(security_zone.vrf_name)", "enable_streaming": false, "ingestion_filter": {}, "interface": "str(interface.if_name or'Vlan%s' % (vn_instance.vlan_id))", "neighbor_addr": "str(remote_interface.ipv4_addr.split('/')[0])"}}, {"inputs": {"in": "OSPF session status"}, "type": "match_string", "name": "OSPF expected sessions", "outputs": {"out": "OSPF expected sessions"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "raise_anomaly": false, "enable_streaming": false, "regexp": "'^FULL'", "enable_anomaly_logging": false}}, {"inputs": {"in": "OSPF expected sessions"}, "type": "state_check", "name": "Check active OSPF sessions", "outputs": {"out": "Check active OSPF sessions"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state": "'false'", "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}, {"inputs": {"in": "Check active OSPF sessions"}, "type": "match_count", "name": "OSPF missing sessions", "outputs": {"out": "OSPF missing sessions"}, "properties": {"enable_streaming": false, "group_by": [], "reference_state": "true"}}], "stages": [{"name": "OSPF session status", "retention_duration": 86400}, {"name": "OSPF missing sessions", "retention_duration": 86400}, {"name": "Check active OSPF sessions", "retention_duration": 86400}, {"name": "OSPF expected sessions", "retention_duration": 86400}], "disabled": true}