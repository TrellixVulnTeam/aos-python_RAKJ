{"label": "Virtual_Infra - Hypervisor missing LLDP config", "processors": [{"inputs": {}, "type": "generic_graph_collector", "name": "Hypervisor NIC LLDP config", "outputs": {"out": "Hypervisor NIC LLDP config"}, "properties": {"protocol": "str(ldp.protocol)", "graph_query": "match(  node('hypervisor', name='hypervisor').out('has')  .node('pnic', name='pnic').out('policy')  .node('link_discovery_policy', name='ldp'))", "data_type": "dss", "hypervisor": "str(hypervisor.label)", "value": "'false' if ldp.protocol == 'lldp' and ldp.operation in ['advertise', 'both'] else 'true'", "value_map": {"0": "false", "1": "true"}, "switch_label": "str(ldp.label)", "enable_streaming": false, "pnic": "str(pnic.label)"}}, {"inputs": {"in": "Hypervisor NIC LLDP config"}, "type": "match_count", "name": "LLDP config by switch", "outputs": {"out": "LLDP config by switch"}, "properties": {"enable_streaming": false, "group_by": ["switch_label"], "reference_state": "true"}}, {"inputs": {"in": "LLDP config by switch"}, "type": "range_check", "name": "Switches missing LLDP config", "outputs": {"out": "Switches missing LLDP config anomaly"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": true, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}], "stages": [{"name": "Hypervisor NIC LLDP config", "retention_duration": 86400}, {"name": "LLDP config by switch", "retention_duration": 86400}, {"name": "Switches missing LLDP config anomaly", "retention_duration": 86400}], "disabled": true}