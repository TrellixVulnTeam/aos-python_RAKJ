{"label": "Virtual_Infra - VMs without Fabric configured VLANs", "processors": [{"inputs": {}, "type": "generic_graph_collector", "name": "VMs backed by Fabric VLANs", "outputs": {"out": "VMs backed by Fabric VLANs"}, "properties": {"vnic": "str(vnic.label)", "virtual_machine": "str(vm.label)", "graph_query": "match(node('system', name='server', role='l2_server').out('hosted_interfaces').node('interface', name='server_intf').out('hosted_vn_endpoints').node('vn_endpoint', name='vn_endpoint').in_('member_endpoints').node('virtual_network').out('instantiated_by').node('vn_instance', name='vn_instance').having(node(name='vn_instance').in_('hosted_vn_instances').node('system', system_id=not_none(), deploy_mode='deploy').out('hosted_interfaces').node('interface').out('link').node('link').in_('link').node('interface').in_('hosted_interfaces').node(name='server'), at_least=1),node(name='server').in_('is_realized_by').node('hypervisor', name='hv'),node(name='hv').out('hosts').node('vm', name='vm').out('has').node('vnic', name='vnic').out('part_of').node('vnet', vn_type='vlan', name='vnet')).distinct(['server', 'vn_endpoint','vnet', 'vm']).where(lambda vnet, vn_instance, vn_endpoint: ((vnet.vlan==0 and vn_endpoint.tag_type=='untagged') or vnet.vlan==vn_instance.vlan_id))", "data_type": "ns", "hypervisor": "str(hv.label)", "vlan": "int(vnet.vlan)", "value": "1", "server": "str(server.label)", "interface": "str(server_intf.id)", "vnet": "str(vnet.label)", "enable_streaming": false, "interface_desc": "str(server_intf.description)", "virtual_machine_ip": "str(vm.ip or \"\")"}}, {"inputs": {}, "type": "generic_graph_collector", "name": "VMs on hypervisors connected to Fabric", "outputs": {"out": "VMs on hypervisors connected to Fabric"}, "properties": {"vnic": "str(vnic.label)", "virtual_machine": "str(vm.label)", "graph_query": ["match(node('system', name='server', system_type='server').in_('is_realized_by').node('hypervisor', name='hv').out('has').node('pnic', name='hv_nic').out('carries').node('vnet', vn_type='vlan', name='vnet').in_('part_of').node('vnic', name='vnic').in_('has').node('vm', name='vm'),node(name='hv').out('hosts').node(name='vm'),node(name='hv_nic').out('is_realized_by').node('interface').in_('composed_of').node('interface', name='server_intf')).distinct(['server', 'server_intf','vnet','vm'])", "match(node('system', name='server', system_type='server').in_('is_realized_by').node('hypervisor', name='hv').out('has').node('pnic', name='hv_nic').out('carries').node('vnet', vn_type='vlan', name='vnet').in_('part_of').node('vnic', name='vnic').in_('has').node('vm', name='vm'),node(name='hv').out('hosts').node(name='vm'),node(name='hv_nic').out('is_realized_by').node('interface', name='server_intf').having(node(name='server_intf').in_('composed_of').node('interface'), at_most=0))"], "data_type": "ns", "hypervisor": "str(hv.label)", "vlan": "int(vnet.vlan)", "value": "1", "server": "str(server.label)", "interface": "str(server_intf.id)", "vnet": "str(vnet.label)", "enable_streaming": false, "interface_desc": "str(server_intf.description)", "virtual_machine_ip": "str(vm.ip or \"\")"}}, {"inputs": {"A": "VMs backed by Fabric VLANs", "B": "VMs on hypervisors connected to Fabric"}, "type": "set_comparison", "name": "Differences between Fabric and Hypervisor", "outputs": {"A & B": "VMs backed by VLANs on Fabric", "B - A": "VMs not backed by Fabric VLANs", "A - B": "NA"}, "properties": {"enable_streaming": false, "significant_keys": ["interface", "vlan", "virtual_machine", "virtual_machine_ip", "vnic", "vnet", "hypervisor"]}}, {"inputs": {"in": "VMs not backed by Fabric VLANs"}, "type": "range_check", "name": "Affected VM Anomalies", "outputs": {"out": "Affected VM Anomalies"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": true, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}], "stages": [{"name": "NA", "retention_duration": 86400}, {"name": "VMs on hypervisors connected to Fabric", "retention_duration": 86400}, {"name": "VMs backed by Fabric VLANs", "retention_duration": 86400}, {"name": "VMs backed by VLANs on Fabric", "retention_duration": 86400}, {"name": "VMs not backed by Fabric VLANs", "retention_duration": 86400}, {"name": "Affected VM Anomalies", "retention_duration": 86400}], "disabled": true}