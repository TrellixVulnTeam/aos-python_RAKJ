{"label": "Overlay - Percentage of BUM packets over a VTEP", "processors": [{"inputs": {}, "type": "generic_data_collector", "name": "Collect BUM packet percentage on each vtep", "outputs": {"out": "bum_to_total_percentage"}, "properties": {"graph_query": "match(node('system', name='leaf', role='leaf', deploy_mode='deploy').out('hosted_interfaces').node('interface', name='self_logical_vtep', if_type='logical_vtep', ipv4_addr=not_none()),node('interface', name='logical_vtep', if_type='logical_vtep', ipv4_addr=not_none())).ensure_different('self_logical_vtep', 'logical_vtep')", "data_type": "ns", "service_interval": "120", "service_name": "vtep_counters", "execution_count": "-1", "system_id": "leaf.system_id", "service_input": "\"\"", "key": "'%s_bum_to_total_percentage' % logical_vtep.ipv4_addr.partition('/')[0]", "enable_streaming": false}}, {"inputs": {"in": "bum_to_total_percentage"}, "type": "range_check", "name": "BUM percentage exceeds threshold", "outputs": {"out": "bum_exceeds_threshold"}, "properties": {"enable_streaming": false, "property": "value", "range": {"min": 11}, "raise_anomaly": true, "graph_query": []}}, {"inputs": {"in": "bum_to_total_percentage"}, "type": "accumulate", "name": "BUM percentage history", "outputs": {"out": "bum_to_total_percentage_history"}, "properties": {"enable_streaming": false, "max_samples": 50, "graph_query": [], "total_duration": 0}}, {"inputs": {"in": "bum_exceeds_threshold"}, "type": "accumulate", "name": "BUM percentage anomalies history", "outputs": {"out": "bum_traffic_anomaly_history"}, "properties": {"enable_streaming": false, "max_samples": 50, "graph_query": [], "total_duration": 0}}], "disabled": true}