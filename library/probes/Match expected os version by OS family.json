{"label": "Compliance - Match expected os version by OS family", "processors": [{"inputs": {}, "type": "generic_data_collector", "name": "OS version collector", "outputs": {"out": "os_version"}, "properties": {"data_type": "ts", "graph_query": "node('system', name='system', system_id=not_none(), deploy_mode='deploy').out('interface_map').node('interface_map').out('device_profile').node('device_profile', name='device_type_node').where(lambda device_type_node:'junos'.lower() in device_type_node.selector['os'].lower())", "service_interval": "120", "service_name": "device_info", "hostname": "str(system.hostname)", "device_type": "str(device_type_node.label)", "execution_count": "-1", "system_id": "system.system_id", "service_input": "\"\"", "key": "'os_version'", "enable_streaming": false}}, {"inputs": {"in": "os_version"}, "type": "match_string", "name": "Match expected OS version", "outputs": {"out": "Match expected OS version"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "raise_anomaly": false, "enable_streaming": true, "regexp": "'20.2R1.10'", "enable_anomaly_logging": false}}, {"inputs": {"in": "Match expected OS version"}, "type": "state_check", "name": "Check mismatched OS versions", "outputs": {"out": "Check mismatched OS versions"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state": "'false'", "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}], "stages": [{"name": "Match expected OS version", "retention_duration": 86400}, {"name": "os_version", "retention_duration": 86400}, {"name": "Check mismatched OS versions", "retention_duration": 86400}], "disabled": true}