{"label": "Overlay - EVPN VXLAN Type-3 Route Validation", "description": "The probe validates EVPN Type 3 routes", "processors": [{"inputs": {}, "type": "evpn3", "name": "EVPN Type 3 Routes", "outputs": {"routes": "EVPN Table", "missing": "Number of missing routes"}, "properties": {"monitored_vn": "", "service_name": "evpn_vxlan_type3", "service_interval": "600.0", "enable_streaming": false, "execution_count": "-1"}}, {"inputs": {"in": "Number of missing routes"}, "type": "range_check", "name": "Missing Routes", "outputs": {"out": "Missing Routes"}, "properties": {"graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "range": {"min": 1}, "raise_anomaly": false, "enable_streaming": false, "property": "value", "enable_anomaly_logging": false}}, {"inputs": {"in": "Missing Routes"}, "type": "time_in_state_check", "name": "Sustained Missing Routes", "outputs": {"out": "Sustained Anomalies"}, "properties": {"time_window": 660, "graph_query": [], "anomaly_retention_size": 1073741824, "anomaly_retention_duration": 86400, "state_range": {"\"true\"": [{"min": 660}]}, "raise_anomaly": true, "enable_streaming": false, "enable_anomaly_logging": false}}, {"inputs": {"in": "Sustained Anomalies"}, "type": "match_count", "name": "Total number of sustained anomalies per SystemID, VNI", "outputs": {"out": "Number of Sustained Anomalies"}, "properties": {"enable_streaming": false, "group_by": [], "reference_state": "true"}}], "stages": [{"name": "Number of missing routes", "retention_duration": 86400, "description": "Number of missing routes grouped by System and VNI."}, {"name": "Missing Routes", "retention_duration": 86400, "description": "Show anomalies for System and VNI if there are missing routes sustained over the specified duration."}, {"name": "Sustained Anomalies", "retention_duration": 86400, "description": "Raises an anomaly per System and VNI when missing routes are present longer that Anomaly Time Window."}, {"name": "Number of Sustained Anomalies", "retention_duration": 86400, "description": "Show total number of sustained anomalies."}, {"name": "EVPN Table", "retention_duration": 86400, "description": "EVPN Type 3 Routing Table."}], "disabled": true}